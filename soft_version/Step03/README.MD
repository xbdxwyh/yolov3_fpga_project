这里是第三步的改动后的代码，基本上改动不大
